<!DOCTYPE html>
<html>
  <head>
    <title>MLB Standings</title>
    <link rel="stylesheet" type="text/css" href="standings.css">
  </head>
  <body>
    <div class="american league">
      <h1>American League Standings</h1>
      <div class="east division">
	<table cellspacing="0">
	  <tr>
	    <th class="division-name" colspan="2">East</th>
	    <th>W</th>
	    <th>L</th>
	    <th>PCT</th>
	    <th>GB</th>
	    <th>L10</th>
	  </tr>
	</table>
      </div>
      <div class="central division">
	<table cellspacing="0">
	  <tr>
	    <th class="division-name" colspan="2">Central</th>
	    <th>W</th>
	    <th>L</th>
	    <th>PCT</th>
	    <th>GB</th>
	    <th>L10</th>
	  </tr>
	</table>
      </div>
      <div class="west division">
	<table cellspacing="0">
	  <tr>
	    <th class="division-name" colspan="2">West</th>
	    <th>W</th>
	    <th>L</th>
	    <th>PCT</th>
	    <th>GB</th>
	    <th>L10</th>
	  </tr>
	</table>
      </div>
    </div>
    <div class="national league">
      <h1>National League Standings</h1>
      <div class="east division">
	<table cellspacing="0">
	  <tr>
	    <th class="division-name" colspan="2">East</th>
	    <th>W</th>
	    <th>L</th>
	    <th>PCT</th>
	    <th>GB</th>
	    <th>L10</th>
	  </tr>
	</table>
      </div>
      <div class="central division">
	<table cellspacing="0">
	  <tr>
	    <th class="division-name" colspan="2">Central</th>
	    <th>W</th>
	    <th>L</th>
	    <th>PCT</th>
	    <th>GB</th>
	    <th>L10</th>
	  </tr>
	</table>
      </div>
      <div class="west division">
	<table cellspacing="0">
	  <tr>
	    <th class="division-name" colspan="2">West</th>
	    <th>W</th>
	    <th>L</th>
	    <th>PCT</th>
	    <th>GB</th>
	    <th>L10</th>
	  </tr>
	</table>
      </div>
    </div>
  </body>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script typ="text/javascript">

var dataURL = 'https://erikberg.com/mlb/standings.json';

function populateStandings( data ){
    populateDivision( $('.american .east tbody'),
		      getDivision(data.standing, 'AL', 'E'));

    populateDivision( $('.american .central tbody'),
		      getDivision(data.standing, 'AL', 'C'));
    
    populateDivision( $('.american .west tbody'),
		      getDivision(data.standing, 'AL', 'W'));

    populateDivision( $('.national .east tbody'),
		      getDivision(data.standing, 'NL', 'E'));

    populateDivision( $('.national .central tbody'),
		      getDivision(data.standing, 'NL', 'C'));
    
    populateDivision( $('.national .west tbody'),
		      getDivision(data.standing, 'NL', 'W'));
}

function getDivision( data, l, d ){
    return data
	.filter( function(t) { return t.conference === l && t.division === d } )
	.sort( function(a, b) { return a.rank - b.rank } );
}

function populateDivision(tbody, teams){
    teams.forEach(function(team){
	tbody.append( createEntry( team ) );
    });
}

function createEntry(team){
    return ('<tr>'+
            '<td class="logo" style="background-image: url(img/'+team.last_name.replace(/\s+/g, '').toLowerCase()+'.png)"></td>'+
	    '<td class="team">'+team.last_name+'</td>'+
	    '<td class="wins">'+team.won+'</td>'+
	    '<td class="losses">'+team.lost+'</td>'+
	    '<td class="winning-percentage">'+team.win_percentage+'</td>'+
	    '<td class="games-back">'+team.games_back+'</td>'+
	    '<td class="last-ten">'+team.last_ten+'</td>');
}

$(function() {
    $.getJSON(dataURL).done(populateStandings)
});
  </script>
</html>
